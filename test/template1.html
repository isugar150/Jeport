<!DOCTYPE html>
<html>

<head>
  <script src="../src/jeport.js"></script>
  <link rel="stylesheet" href="../src/jeport.css" />

  <style>
    table {
      width: 100%;
      margin-top: 0;
      border: 1px solid #000;

    }

    tr,
    tr th,
    tr td {
      border: 1px solid #000;
      padding: 0;
      margin: 0;
    }

    table>th {
      padding: 4px;
      text-align: center;

      & span {
        color: rgba(0, 0, 0, 0.6);
      }
    }

    th p {
      margin-top: 5px;
      font-size: 8px;
      font-weight: normal;
    }

    td {
      padding: 5px;
      color: #000;
      font-weight: normal;
      font-size: 10px;
      height: 25px;
    }

    * {
      font-size: 12px;
    }

    th,
    td {
      border: 1px solid #000;
    }
  </style>
</head>

<body>
  <header>
    <div style="display: flex; align-items: center; justify-content: space-between">
      <div></div>
      <div>Title</div>
      <div>
        <button onclick="jeport.print()">인쇄</button>
      </div>
    </div>
  </header>
  <div class="content">
    <div class="landscape">
      <table class="input_table" id="riskThreeTypeFirstTable">
        <colgroup>
          <col width="10%" />
          <col width="10%" />
          <col width="15%" />
          <col width="15%" />
          <col width="5%" />
          <col width="5%" />
          <col width="5%" />
          <col width="30%" />
        </colgroup>

        <thead>
          <tr>
            <th>공사명</th>
            <td align="center" colspan="2" id="riskThreeTypeFirstSiteName"></td>

            <th rowspan="8" colspan="5" style="font-size:20px">최 초 위 험 성 평 가</th>
          </tr>
          <tr>
            <th>작성일</th>
            <td align="center" colspan="2" id="riskThreeTypeFirstCreateDate"></td>
          </tr>
          <tr>
            <th>공사기간</th>
            <td align="center" colspan="2" id="riskThreeTypeFirstsiteWorkDate"></td>
          </tr>
        </thead>

        <tbody id="riskThreeTypeFirstTableBody">
          <tr>
            <th rowspan="2">공종</th>
            <th rowspan="2">단위작업</th>

            <th rowspan="2" colspan="2">
              유해 위험요인
              <p>(현장주변 상황 및 사고발생 사유 상세히 상세히 기입)</p>
            </th>

            <th colspan="3">
              <div class="flex_row">위험성 결정</div>
            </th>
            <th rowspan="2" colspan="2">
              위험성 감소대책
              <p>(위험성 등급이 허용불가(상,중)인 경우 필수 작성)</p>
            </th>
          </tr>

          <tr>
            <th>
              상
              <p style="font-size:8px">(즉시조치)</p>
            </th>
            <th>
              중
              <p style="font-size:8px">(계획조치)</p>
            </th>
            <th>
              하
              <p style="font-size:8px">(일상관리)</p>
            </th>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="landscape" id="threeTypeEval"></div>
</body>
<script>
  var jeport;
  document.addEventListener("DOMContentLoaded", function () {
    const content = document.getElementsByClassName("content")[0];
    jeport = new Jeport(content, {
      showPageNumbers: true,
      watermark: {
        enabled: false,
        image: "./img/watermark.jpg",
      },
    });
    jeport.init(() => {
      console.log("callback");
      // jeport.print();
    });
  });
  /* 
  * 위험성평가 최초
  */
  let riskThreeTypeFirstInfo = {
    siteName: "온수공원(연의지구) 조성사업(토목)",
    siteWorkDate: "2024-04-01~2025-01-25",
    createDate: "2024-07-05",
    riskThreeTypeFirstItemList: [
      {
        constructionName: "AL폼 작업",
        workTypeName: "AL폼 설치·해체작업",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 안전통로 미확보로 인한 전도발생",
        preventiveMeasures: " 코어주변 및 주출입구 안전통로 확보철저",
      },
      {
        constructionName: "AL폼 작업",
        workTypeName: "AL폼 설치·해체작업",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 계단참 스라브 작업전 통제조치 미흡으로 인한 추락발생",
        preventiveMeasures: " 계단참 통제조치 실시(스라브 작업구간 설치기간 준수)",
      },
      {
        constructionName: "AL폼 작업",
        workTypeName: "AL폼 설치·해체작업",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 작업발판 미사용으로 인한 전도발생",
        preventiveMeasures: " 말비계 및 작업발판 사용철저",
      },
      {
        constructionName: "AL폼 작업",
        workTypeName: "AL폼 설치·해체작업",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 박리제 사용시 코어주변 자재방치로 인한 낙하물 발생",
        preventiveMeasures: " 자재 적재시 코어주변 이격거리 확보  및 내벽적재 구간 사용",
      },
      {
        constructionName: "AL폼 작업",
        workTypeName: "AL폼 설치·해체작업",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 자재반입구 열린 상태로 방치·추락발생",
        preventiveMeasures: " 자재반입시 자재반입구 사용 후 자재반입구 개구부 덮개 사용",
      },
      {
        constructionName: "AL폼 작업",
        workTypeName: "AL폼 설치·해체작업",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 계단 및 E/V PIT 난간대 미설치로 추락",
        preventiveMeasures: " 계단 및 E/V PIT 난간대 즉시 설치",
      },
      {
        constructionName: "AL폼 작업",
        workTypeName: "AL폼 설치·해체작업",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 안전통로 미확보로 인한 전도발생",
        preventiveMeasures: " 코어주변 및 주출입구 안전통로 확보철저",
      },
      {
        constructionName: "AL폼 작업",
        workTypeName: "AL폼 설치·해체작업",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 계단참 스라브 작업전 통제조치 미흡으로 인한 추락발생",
        preventiveMeasures: " 계단참 통제조치 실시(스라브 작업구간 설치기간 준수)",
      },
      {
        constructionName: "AL폼 작업",
        workTypeName: "AL폼 설치·해체작업",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 작업발판 미사용으로 인한 전도발생",
        preventiveMeasures: " 말비계 및 작업발판 사용철저",
      },
      {
        constructionName: "AL폼 작업",
        workTypeName: "AL폼 설치·해체작업",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 박리제 사용시 코어주변 자재방치로 인한 낙하물 발생",
        preventiveMeasures: " 자재 적재시 코어주변 이격거리 확보  및 내벽적재 구간 사용",
      },
      {
        constructionName: "AL폼 작업",
        workTypeName: "AL폼 설치·해체작업",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 자재반입구 열린 상태로 방치·추락발생",
        preventiveMeasures: " 자재반입시 자재반입구 사용 후 자재반입구 개구부 덮개 사용",
      },
      {
        constructionName: "AL폼 작업",
        workTypeName: "AL폼 설치·해체작업",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 계단 및 E/V PIT 난간대 미설치로 추락",
        preventiveMeasures: " 계단 및 E/V PIT 난간대 즉시 설치",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 거치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 굴삭기로 크레인 작업구간 정비작업중 버켓에 주변작업자 충돌 및 협착",
        preventiveMeasures: " 장비작업 반경내 출입금지 조치, 유도자 배치",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 거치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 크레인의 방호장치 작동 불량",
        preventiveMeasures: " 크레인 반입시 방호장치 작동 유무 확인",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 거치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 크레인 지브 경사각 미준수",
        preventiveMeasures: " 크레인 인양하중 조견표의 지브 경사각 준수여부 확인",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 거치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " PSC 거더 거치 조정작업중 와이어로프 회전에 의해 근로자 충돌로 추락",
        preventiveMeasures: " 작업전 와이어로프 점검 PSC 거더 회전반경 밖에 위치하여 작업실시 및 안전대착용 철저",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 거치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 강선삽입시 강선지지대의 전도로 인한 강선의 잘못된 풀림 사고",
        preventiveMeasures: " 강선지지대의 견고한 고정 및 작업자와 안전거리 확보",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 거치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 강선삽입시 반대편 사용자 잘못된 신호로 인한 사고",
        preventiveMeasures: " 무전기등을 이용하여 작업자 상호간 신호철저 및 작업자 보호구 착용철저",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 상차 / 거더 운반(1)",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 적재함에서 인양작업중 인양물에 의해 적재함 단부에서 추락",
        preventiveMeasures:
          " 인양작업시 유도로프 또는 보조기구 사용/인양물 회전반경 밖에서 인양작업 실시 및 신호수 근로자 위치는 양중근로자 시야내에 위치",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 Cross Beam설치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 거더 하부 이동을 위한 통로로 목재사다리 제작 사용중 사다리 파단, 추락",
        preventiveMeasures: " 거더 하부 이동을 위한 통로로 철제사다리를 견고하게 고정 설치",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 Cross Beam설치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 작업발판 설치작업중 미고정 작업발판을 밟아 요동에 의한 추락",
        preventiveMeasures: " 작업발판 설치작업시 발판이 탈락되지 않도록 고정 철저",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 Cross Beam설치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 철근 조립작업중 협소한 통로의 지지대에 걸려 실족",
        preventiveMeasures: " Cross Beam 설치 부위 하부에 추락방지망 설치",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 Cross Beam설치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 거더 외측단부에서 형틀 가공작업중 거더 단부에서 실족",
        preventiveMeasures: " 형틀 가공장소는 내측 거더상에 설정하여 작업하고 안전대 착용",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 Cross Beam설치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 형틀 작업용 달대비계의 설치불량으로 작업도중 실족",
        preventiveMeasures:
          " 달대비계는 요동없도록 고정, 작업이 용이하도록 충분한 작업발판폭 확보, 달대비계의 구조는 충분한 강도 확보",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 Cross Beam설치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 목재 가공용 둥근톱 사용시 방호장치 미설치 상태에서 사용",
        preventiveMeasures: " 목재가공용 둥근톱에 덮개 설치 사용",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 Cross Beam설치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 안전대 미착용하고 PSC 거더 상부로 자재운반하다 돌출철근에 걸려 거더단부로 실족",
        preventiveMeasures:
          " 거더상부에 안전대걸이 시설 설치 및 안전대착용, 인력소운반을 위한 요철이 없는 작업통로 설치",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 상차 / 거더 운반(1)",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " PSC 거더 인양작업중 인양장비 전도",
        preventiveMeasures:
          " 신호수배치/크레인 설치위치 지반지지력 확보/크레인 인양 정격하중 검토 및 아웃트리거 전용받침목 및 타이어 크레인 설치",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 상차 / 거더 운반(1)",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " PSC 인양작업시 PSC 전도",
        preventiveMeasures: " PSC 전도 방지 조치",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 상차 / 거더 운반(1)",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 와이어로프 감아올리기 작업중 와이어로프 걸림에 의한 회전으로 충돌",
        preventiveMeasures: " 인양직후 일단 정지확인후 인양/인양상태 불량시 내린후 재인양 실시",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 상차 / 거더 운반(1)",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 인양장비 및 운반차량 작업반경내 근로자 출입에 의한 충돌",
        preventiveMeasures: " 신호수 배치 및 작업반경내 출입금지 조치",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 상차 / 거더 운반(1)",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 운반차량의 브레이크 고정불량으로 유동에 의한 충돌",
        preventiveMeasures: " 운반차량의 사이드 브레이크 확인 및 비탈면에서는 차륜에 쐐기 설치",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 상차 / 거더 운반(1)",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 크레인 방호장치 불량",
        preventiveMeasures: " 크레인 반입시 방호장치 설치유무 및 작동여부 점검",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 거치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 안전대 미착용하고 PSC 거더 거치작업중 거더단부에서 실족 추락",
        preventiveMeasures: " PSC 거더 거치전 상부에 안전대걸이 로프 선조립후 인양 거치",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 거치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " PSC 거더 거치후 전도방지 조치작업하다 교각 상부에서 추락",
        preventiveMeasures: " 안전대 부착설비 설치 및 안전대 착용후 작업",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 거치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " PSC 거더 거치후 전도방지 조치 불량에 의한 도괴",
        preventiveMeasures: " 전도방지용 와이어로프 또는 용접철근의 적정 개소의 설정 및 작업 준수",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 거치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " PSC 거더 하부에서 추락방지망 설치하다 실족하여 추락",
        preventiveMeasures:
          " 추락방지망 설치방법을 육상작업후 인양거치하는 방법으로 개선, 안전대 부착설비 설치 및 안전대 착용",
      },
      {
        constructionName: "PSC 교량작업",
        workTypeName: "PSC 교량 거더 인양 및 거치",
        upperYn: "Y",
        middleYn: "N",
        lowerYn: "N",
        harmfulRiskFactors: " 크레인 작업장소 지반지지력 부족에 의한 전도",
        preventiveMeasures: " 크레인 작업장소의 지반 보강",
      },
    ],
  };
  document.getElementById("riskThreeTypeFirstSiteName").innerHTML = riskThreeTypeFirstInfo.siteName;
  document.getElementById("riskThreeTypeFirstCreateDate").innerHTML = riskThreeTypeFirstInfo.createDate;
  document.getElementById("riskThreeTypeFirstsiteWorkDate").innerHTML = riskThreeTypeFirstInfo.siteWorkDate;

  for (let i = 0; i < riskThreeTypeFirstInfo?.riskThreeTypeFirstItemList.length; i++) {
    let appendTr = `
        <tr>
          <td>${riskThreeTypeFirstInfo?.riskThreeTypeFirstItemList[i].constructionName}</td>
          <td>${riskThreeTypeFirstInfo?.riskThreeTypeFirstItemList[i].workTypeName}</td>
          <td colspan="2">${riskThreeTypeFirstInfo?.riskThreeTypeFirstItemList[i].harmfulRiskFactors}</td>
          <td align="center">${riskThreeTypeFirstInfo?.riskThreeTypeFirstItemList[i].upperYn === "Y" ? "√" : ""}</td>
          <td align="center">${riskThreeTypeFirstInfo?.riskThreeTypeFirstItemList[i].middleYn === "Y" ? "√" : ""}</td>
          <td align="center"${riskThreeTypeFirstInfo?.riskThreeTypeFirstItemList[i].lowerYn === "Y" ? "√" : ""}</td>
          <td>${riskThreeTypeFirstInfo?.riskThreeTypeFirstItemList[i].preventiveMeasures}</td>
        </tr>
      `;

    console.log(appendTr)
    document.getElementById("riskThreeTypeFirstTableBody").insertAdjacentHTML("beforeend", appendTr);
  }

  /* 
  * 위험성평가 수시
  */
  let riskThreeTypeList = [
    {
      "threeTypeEvalId": "TTE20240705092102969",
      "siteName": "온수공원(연의지구) 조성사업(토목)",
      "evalDate": "2024-07-01~2024-07-31",
      "createDate": "2024-07-05",
      "apprUserList": [
        {
          "documentId": null,
          "approveId": "APPR20240705092103036",
          "approveSeq": "1",
          "userName": "김민정",
          "positionName": "부장",
          "companyUserId": "05953c64-4098-4ac8-ba40-bdb68caacf2b",
          "comment": "승인합니다",
          "status": "APPROVE",
          "title": null,
          "statusName": null,
          "linkUrl": null,
          "reqUserId": null,
          "reqUserName": null
        }
      ],
      "apprRefList": [
        {
          "documentId": null,
          "approveId": "APPR20240705092103036",
          "approveSeq": null,
          "userName": "김인호",
          "positionName": "부장",
          "companyUserId": "a59b1142-68d4-40c3-9c91-56977150fa13",
          "comment": null,
          "status": null,
          "title": null,
          "statusName": null,
          "linkUrl": null,
          "reqUserId": null,
          "reqUserName": null
        }
      ],
      "riskThreeTypeItemList": [
        {
          "constructionName": "기초파일작업",
          "workTypeName": "기초파일 항타",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " 항타기붐대와 리더의 연결부 탈락에 의한 리더의 전도",
          "preventiveMeasures": " 항타기붐대와 리더의 연결부등 체결상태 작업전 점검실시",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "기초파일작업",
          "workTypeName": "기초파일 항타",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " 항타기 주변에서 작업중 파일 장비 등에 충돌",
          "preventiveMeasures": " 근로자는 안전모, 안전화, 안전대 등 개인보호구 착용 철저",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "기초파일작업",
          "workTypeName": "기초파일 항타",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " 항타작업중 아웃트리거 미설치에 의한 전도",
          "preventiveMeasures": " 항타작업중 항타기 전도방지를 위해 아웃트리거 설치",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "기초파일작업",
          "workTypeName": "기초파일 항타",
          "upperYn": "N",
          "middleYn": "Y",
          "lowerYn": "N",
          "harmfulRiskFactors": " 파일항타중 파일파괴에 의한 파일파편 비산",
          "preventiveMeasures": " 파일항타중 파일 파손여부를 관찰하고 파일파편 비산위험이 있을경우 작업중지 파일교체",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": "2024-07-31",
          "actionName": "김인호"
        },
        {
          "constructionName": "기초파일작업",
          "workTypeName": "기초파일 항타",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " 해머의 타격강도가 과하여 파일파손에 의한 파편 낙하",
          "preventiveMeasures": " 해머의 항타고, 항타강도를 적정하게 유지하여 파일파손 방지",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "기초파일작업",
          "workTypeName": "기초파일 항타",
          "upperYn": "N",
          "middleYn": "N",
          "lowerYn": "Y",
          "harmfulRiskFactors": " 적재된 파일이 굴러내리면서 협착",
          "preventiveMeasures": " 적재된 파일은 굴러내리지 않도록 쐐기 등으로 고정",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": "2024-07-25",
          "actionName": "김민정"
        },
        {
          "constructionName": "기초파일작업",
          "workTypeName": "기초파일 항타",
          "upperYn": "N",
          "middleYn": "N",
          "lowerYn": "Y",
          "harmfulRiskFactors": " 해머를 인상시켜놓고 하부에서 점검중 해머 낙하",
          "preventiveMeasures": " 해머 인상시켜놓고 해머하부에서 작업금지/해머를 이동시키고 파일상태 점검실시",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": "2024-07-31",
          "actionName": "김인호"
        },
        {
          "constructionName": "기초파일작업",
          "workTypeName": "기초파일 항타",
          "upperYn": "N",
          "middleYn": "Y",
          "lowerYn": "N",
          "harmfulRiskFactors": " 근로자가 안전모등 개인보호구 미착용에 의한 충돌·추락",
          "preventiveMeasures": " 근로자는 안전모, 안전화, 안전대 등 개인보호구 착용 철저",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": "2024-07-31",
          "actionName": "김민정"
        },
        {
          "constructionName": "기초파일작업",
          "workTypeName": "기초파일 항타",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " 파일 과적재에 따른 적재된 파일 붕괴",
          "preventiveMeasures": " 파일적재시 자체하중에 의해 붕괴되지 않도록 적정한 높이로 적재",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "기초파일작업",
          "workTypeName": "기초파일 항타",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " 항타작업중 항타기 붐대가 부러지면서 항타기 리더 전도",
          "preventiveMeasures": " 항타기는 붐대견고성, 기계장치의 이상유무 등을 사전점검하고 작업실시",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "기초파일작업",
          "workTypeName": "기초파일 항타",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " 항타기 회전중 후면부에 근로자 충돌",
          "preventiveMeasures": " 항타기 후면부에 접근금지 위험표지 설치/신호수에 의한 근로자유도",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "기초파일작업",
          "workTypeName": "기초파일 항타",
          "upperYn": "N",
          "middleYn": "Y",
          "lowerYn": "N",
          "harmfulRiskFactors": " 항타기운행 또는 파일항타중 지반침하에 의한 전도",
          "preventiveMeasures": " 항타기하부에는 침하방지 조치",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": "2024-07-19",
          "actionName": "김민정"
        },
        {
          "constructionName": "흙막이지보공 작업",
          "workTypeName": "흙막이지보공 자재반입",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " 이동식크레인 회전중 크레인 후면부에 근로자 충돌",
          "preventiveMeasures": " 이동식크레인 충돌위험부위에 접근위험 표지설치/신호수에 의해 주변근로자 통제",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "흙막이지보공 작업",
          "workTypeName": "흙막이지보공 자재반입",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " H-pile 등 자재인양시 이동식크레인 붐이 꺾이면서 자재 낙하",
          "preventiveMeasures": " 이동식크레인은 반입후 본체, 붐대 연결부 유압장치 등의 이상유무 확인",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "흙막이지보공 작업",
          "workTypeName": "흙막이지보공 자재반입",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " 이동식크레인 운전원의 조작미숙에 의한 자재 낙하",
          "preventiveMeasures": " 이동식크레인 운전원 자격유무, 경험유무 확인/작업의 적정성 사전점검",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "흙막이지보공 작업",
          "workTypeName": "흙막이지보공 자재반입",
          "upperYn": "N",
          "middleYn": "Y",
          "lowerYn": "N",
          "harmfulRiskFactors": " 근로자의 개인보호구 미착용에 의해 부딪히거나 추락",
          "preventiveMeasures": "  근로자 개인보호구 착용 철저",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": "2024-07-31",
          "actionName": "김민정"
        },
        {
          "constructionName": "흙막이지보공 작업",
          "workTypeName": "흙막이지보공 자재반입",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " 아웃트리거 하부 받침대탈락 또는 부러지면서 충격으로 자재요동에 의한 근로자 충돌",
          "preventiveMeasures": " 아웃트리거의 하부받침대는 하중에 견딜 수 있는 규격 품 사용",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "흙막이지보공 작업",
          "workTypeName": "흙막이지보공 자재반입",
          "upperYn": "N",
          "middleYn": "N",
          "lowerYn": "Y",
          "harmfulRiskFactors": " 이동식크레인 인양작업중 지반부 등 침하에 의한 크레인 전도",
          "preventiveMeasures": " 이동식크레인은 견고하고 평탄한 지반에서 설치",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": "2024-07-31",
          "actionName": "김인호"
        },
        {
          "constructionName": "흙막이지보공 작업",
          "workTypeName": "흙막이지보공 자재반입",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " 자재받침대 파손에 의해 적재된 자재 붕괴",
          "preventiveMeasures": " 자재받침대는 상재하중에 충분히 견딜 수 있는 재료를 사용",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "흙막이지보공 작업",
          "workTypeName": "흙막이지보공 자재반입",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " H-beam을 1줄 1걸이로 결속하여 인양중 흔들리는 자재와 근로자 충돌",
          "preventiveMeasures": " H-beam 결속시 2줄 2걸이로 견고하게 결속, 인양시 수평유지",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "흙막이지보공 작업",
          "workTypeName": "흙막이지보공 자재반입",
          "upperYn": "Y",
          "middleYn": "N",
          "lowerYn": "N",
          "harmfulRiskFactors": " 작업시 신호수 미배치에 따라 자재인양, 이동식크레인 회전중 주변근로자 충돌",
          "preventiveMeasures": " 이동식크레인 작업시 신호수 배치하여 안전하게 장비유도/주변 근로자 통제 및 작업장 주변 출입통제",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": null,
          "actionName": null
        },
        {
          "constructionName": "흙막이지보공 작업",
          "workTypeName": "흙막이지보공 자재반입",
          "upperYn": "N",
          "middleYn": "Y",
          "lowerYn": "N",
          "harmfulRiskFactors": " 이동식크레인 후크에서 와이어로프 탈락으로 자재 낙하",
          "preventiveMeasures": " 이동식크레인 후크에는 와이어로프 탈락방지용 후크 해지장치 설치",
          "confirmDate": null,
          "confirmName": null,
          "actionDate": "2024-07-26",
          "actionName": "김민정"
        }
      ],
      "riskConferenceList": [
        {
          "conferenceDate": "07-02~07-05",
          "workerOpinion": "근로자 사고 형태 확인",
          "riskAssessmentResult": "회의 결과에 따른 요구사항 정리",
          "attendeeList": [
            {
              "attendeeName": "김인구",
              "fileId": "FILE20240705101738739",
              "fileSeq": 1
            },
            {
              "attendeeName": "이영호",
              "fileId": "FILE20240705101743549",
              "fileSeq": 1
            }
          ],
          "conferenceList": [
            {
              "actionDate": "2024-07-02",
              "actionContent": "위험성평가 회의 1회차",
              "actionAfterFileId": "FILE20240705095747948",
              "actionAfterFileSeq": 1
            }
          ]
        },
        {
          "conferenceDate": "07-08~07-12",
          "workerOpinion": "주간 근로자 청취 진행",
          "riskAssessmentResult": "진행사항 공유예정",
          "attendeeList": [
            {
              "attendeeName": "구연서",
              "fileId": "FILE20240705101715914",
              "fileSeq": 1
            },
            {
              "attendeeName": "김민수",
              "fileId": "FILE20240705101720539",
              "fileSeq": 1
            },
            {
              "attendeeName": "한연석",
              "fileId": "FILE20240705101729955",
              "fileSeq": 1
            }
          ],
          "conferenceList": [
            {
              "actionDate": "2024-07-08",
              "actionContent": "위험성평가회의 2회차",
              "actionAfterFileId": "FILE20240705100148164",
              "actionAfterFileSeq": 1
            }
          ]
        }
      ],
      "actionList": [
        {
          "actionDate": "2024-07-31",
          "actionContent": "조치 진행",
          "actionAfterFileId": "FILE20240705093417806",
          "actionAfterFileSeq": 1
        },
        {
          "actionDate": "2024-07-31",
          "actionContent": "처리",
          "actionAfterFileId": "FILE20240705094159649",
          "actionAfterFileSeq": 1
        },
        {
          "actionDate": "2024-07-19",
          "actionContent": "조치내용대로 처리하였습니다.",
          "actionAfterFileId": "FILE20240705092518302",
          "actionAfterFileSeq": 1
        },
        {
          "actionDate": "2024-07-25",
          "actionContent": "적재된 파일 정리 완료",
          "actionAfterFileId": "FILE20240705092615730",
          "actionAfterFileSeq": 1
        },
        {
          "actionDate": "2024-07-31",
          "actionContent": "조치진행",
          "actionAfterFileId": "FILE20240705093927502",
          "actionAfterFileSeq": 1
        },
        {
          "actionDate": "2024-07-26",
          "actionContent": "조치완료",
          "actionAfterFileId": "FILE20240705095548608",
          "actionAfterFileSeq": 1
        },
        {
          "actionDate": "2024-07-31",
          "actionContent": "내용처리",
          "actionAfterFileId": "FILE20240705092700464",
          "actionAfterFileSeq": 1
        },
        {
          "actionDate": "2024-07-31",
          "actionContent": "처리완료",
          "actionAfterFileId": "FILE20240705093313937",
          "actionAfterFileSeq": 1
        }
      ]
    }
  ];

  for (let i = 0; i < riskThreeTypeList.length; i++) {
    let table = `
    <table class="input_table">
          <colgroup>
            <col width="10%" />
            <col width="10%" />
            <col width="15%" />
            <col width="15%" />
            <col width="6%" />
            <col width="6%" />
            <col width="6%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
            <col width="5%" />
          </colgroup>
          
            <thead>
              <tr>
                <th rowSpan=2>
                공사명
                </th>
                <td align="center" rowSpan=2 colSpan=2 id="riskThreeTypeEvalSiteName"> 
                  ${riskThreeTypeList[i].siteName}
                </td>
  
                <th rowSpan=4 colSpan=5 style="font-size:20px">
                  상 시 위 험 성 평 가
                </th>
                <th colSpan=5>
                  결재
                </th>
              </tr>
              <tr>
                ${riskThreeTypeList[i].apprUserList?.map((user) => { return `<td align="center">${user?.positionName}</td>`; })}
              </tr>
  
              <tr>
                <th>
                  평가 반영기간
                </th>
                <td align="center" colSpan=2 id="riskThreeTypeEvalEvalDate">
                  ${riskThreeTypeList[i].evalDate}
                </td>
                ${riskThreeTypeList[i].apprUserList?.map((user) => { return `<td align="center">${user?.userName}</td>`; })}
              </tr>
              <tr>
                <th>
                  작성일
                </th>
                <td align="center" colSpan=2 id="riskThreeTypeEvalCreateDate">
                  ${riskThreeTypeList[i].createDate}
                </td>
                ${riskThreeTypeList[i].apprUserList?.map((user) => {
      return (` <td align="center">${user?.status === "APPROVE" ? "승인" : user?.status === "REJECT" ? "반려" : ""}</td>`);
    })}
              </tr>
            </thead>
          
          <tbody>
        
              
                <tr>
                  <th rowSpan=2>
                    공종
                  </th>
                  <th rowSpan=2>
                    단위작업
                  </th>
  
                  <th rowSpan=2 colSpan=2>
                    유해 위험요인
                    <p>(현장주변 상황 및 사고발생 사유 상세히 상세히 기입)</p>
                  </th>
  
                  <th colSpan=3>
                    <div class="flex_row" style="justify-content: center">
                      위험성 결정
                    </div>
                  </th>
                  <th rowSpan=2 colSpan=5>
                    위험성 감소대책
                    <p>(위험성 등급이 허용불가(상,중)인 경우 필수 작성)</p>
                  </th>
                  <th rowSpan=2 colSpan=1>
                    이행확인
                    <p  style="font-size:8px">(개선조치일)</p>
                  </th>
                </tr>
                <tr>
                  <th>
                    상
                    <p  style="font-size:8px">(즉시조치)</p>
                  </th>
                  <th>
                    중
                    <p  style="font-size:8px">(계획조치)</p>
                  </th>
                  <th>
                    하
                    <p  style="font-size:8px">(일상관리)</p>
                  </th>
                </tr>
            `;
    for (var j = 0; j < riskThreeTypeList[i]?.riskThreeTypeItemList.length; j++) {
      let data = riskThreeTypeList[i]?.riskThreeTypeItemList[j];
      table += `<tr>
                  <td>${data.constructionName}</td>
                  <td>${data.workTypeName}</td>
                  <td colSpan=2>${data.harmfulRiskFactors}</td>
                  <td align="center">${data.lowerYn === "Y" ? "√" : ""}</td>
                  <td align="center">${data.middleYn === "Y" ? "√" : ""}</td>
                  <td align="center">${data.upperYn === "Y" ? "√" : ""}</td>
                  <td colSpan=5>${data.preventiveMeasures}</td>
                  <td>${data?.actionDate && data?.actionName + "(" + data?.actionDate + ")"}</td>
                </tr>`
    }
    table += `
            <div class="_jeport_page-brake"></div>
                  <tr>
                    <th>
                      일시
                    </th>
                    <th colSpan=4>
                      주간 근로자 의견청취
                      <p  style="font-size:8px">(아차사고, 안전시설 개선, 안전장구류 지급 등) </p>
                    </th>
                    <th colSpan=8>
                      주간 위험성평가 회의 및 결과 공유
                      <p  style="font-size:8px">(근로자 의견청취 내용을 기반으로 위험성평가 실시)</p>
                    </th>
                  </tr>
                  
                  `;
    for (var j = 0; j < riskThreeTypeList[i]?.riskConferenceList.length; j++) {
      let data = riskThreeTypeList[i]?.riskConferenceList[j];
      table += `<tr>
                      <td align="center">${data?.conferenceDate}</td>
                      <td colSpan=4>${data?.workerOpinion}</td>
                      <td colSpan=8>${data?.riskAssessmentResult}</td>
                    </tr>`
    }
    table += `

                
          </tbody>
        </table>
      `;
    document.getElementById("threeTypeEval").insertAdjacentHTML("beforeend", table);
  }


</script>

</html>